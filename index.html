<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simulador de Protocolo de Timestamps - Visualiza√ß√£o</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üîÑ Simulador de Protocolo de Timestamps</h1>
            <p>Visualiza√ß√£o Interativa de Controle de Concorr√™ncia</p>
        </div>

        <div class="content">
            <!-- Se√ß√£o de Entrada Personalizada -->
            <div class="custom-input-section">
                <h3>‚úèÔ∏è Criar Hist√≥ria Personalizada</h3>
                <div class="input-group">
                    <div class="input-field">
                        <label for="customName">Nome do Cen√°rio</label>
                        <input type="text" id="customName" placeholder="Ex: Meu Teste Personalizado">
                    </div>
                </div>
                <div class="input-group">
                    <div class="input-field">
                        <label for="customOperations">Opera√ß√µes (separadas por v√≠rgula ou espa√ßo)</label>
                        <textarea id="customOperations" placeholder="Ex: r1(x), w1(x), r2(x), w2(x), c1, c2"></textarea>
                        <div class="input-examples">
                            <strong>Exemplos:</strong><br>
                            ‚Ä¢ <code>r1(x)</code> - Transa√ß√£o 1 l√™ X<br>
                            ‚Ä¢ <code>w2(y)</code> - Transa√ß√£o 2 escreve Y<br>
                            ‚Ä¢ <code>c3</code> - Transa√ß√£o 3 faz commit
                        </div>
                    </div>
                </div>
                <button class="btn btn-primary" onclick="adicionarCenarioPersonalizado()">‚ûï Adicionar Cen√°rio</button>
                <button class="btn btn-secondary" onclick="abrirModalExemplos()">üìö Ver Exemplos</button>
            </div>

            <div class="controls">
                <select id="scenarioSelect" aria-label="Selecione um cen√°rio" title="Selecione um cen√°rio">
                    <option value="">Selecione um cen√°rio...</option>
                </select>
                <button class="btn btn-primary" id="startBtn" onclick="iniciarSimulacao()">‚ñ∂Ô∏è Iniciar</button>
                <button class="btn btn-secondary" id="nextBtn" onclick="proximoPasso()" disabled>‚û°Ô∏è Pr√≥ximo Passo</button>
                <button class="btn btn-secondary" id="autoBtn" onclick="executarAutomatico()" disabled>‚ö° Auto</button>
                <button class="btn btn-danger" id="resetBtn" onclick="resetarSimulacao()" disabled>üîÑ Resetar</button>
            </div>

            <div class="progress-bar">
                <div class="progress-fill" id="progressBar" style="width: 0%"></div>
            </div>

            <div class="step-info" id="stepInfo" style="display: none;">
                <h3>Passo <span id="stepNumber">0</span> de <span id="totalSteps">0</span></h3>
                <div>Processando opera√ß√£o: <span class="operation-display" id="currentOperation">-</span></div>
            </div>

            <div id="messages"></div>

            <div class="grid">
                <div class="card">
                    <h3>üìä Hist√≥ria Final (HF)</h3>
                    <div class="hf-timeline" id="hfTimeline">
                        <div class="empty-state">
                            <p>Nenhuma opera√ß√£o executada ainda</p>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <h3>üíæ Itens de Dados</h3>
                    <div id="dataItems">
                        <div class="empty-state">
                            <p>Nenhum item de dado acessado</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="grid">
                <div class="card">
                    <h3>üîê Transa√ß√µes Ativas</h3>
                    <div id="transactions">
                        <div class="empty-state">
                            <p>Nenhuma transa√ß√£o iniciada</p>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <h3>üìù Hist√≥ria Inicial (HI)</h3>
                    <div id="initialHistory">
                        <div class="empty-state">
                            <p>Selecione um cen√°rio para come√ßar</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="legend">
                <div class="legend-item">
                    <div class="legend-color" style="background: #48bb78;"></div>
                    <span>Commit</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: #667eea;"></div>
                    <span>Ativa</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: #f56565;"></div>
                    <span>Abortada</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de Exemplos -->
    <div class="modal" id="examplesModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>üìö Exemplos de Opera√ß√µes</h2>
                <button class="close-modal" onclick="fecharModalExemplos()">‚úï</button>
            </div>
            <div>
                <h3>Formato das Opera√ß√µes</h3>
                <p style="margin-bottom: 15px;">Cada opera√ß√£o deve seguir o formato:</p>
                
                <div style="background: #f7fafc; padding: 15px; border-radius: 8px; margin-bottom: 20px;">
                    <strong>Leitura:</strong> <code>r{transa√ß√£o}({item})</code><br>
                    Exemplo: <code>r1(x)</code> - Transa√ß√£o 1 l√™ o item X<br><br>
                    
                    <strong>Escrita:</strong> <code>w{transa√ß√£o}({item})</code><br>
                    Exemplo: <code>w2(y)</code> - Transa√ß√£o 2 escreve no item Y<br><br>
                    
                    <strong>Commit:</strong> <code>c{transa√ß√£o}</code><br>
                    Exemplo: <code>c3</code> - Transa√ß√£o 3 faz commit
                </div>

                <h3>Exemplos Completos</h3>
                
                <div style="background: #f7fafc; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                    <strong>Exemplo 1: Execu√ß√£o Serial</strong><br>
                    <code>r1(x), w1(x), c1, r2(x), c2</code><br>
                    <small style="color: #718096;">T1 l√™ e escreve X, depois T2 l√™ X. Sem conflitos.</small>
                </div>

                <div style="background: #f7fafc; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                    <strong>Exemplo 2: Conflito de Escrita</strong><br>
                    <code>w1(z), r2(z), w3(z), w2(z), c1, c3, c2</code><br>
                    <small style="color: #718096;">T2 ser√° abortada quando tentar escrever ap√≥s T3.</small>
                </div>

                <div style="background: #f7fafc; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                    <strong>Exemplo 3: M√∫ltiplas Transa√ß√µes</strong><br>
                    <code>r1(x), r2(x), r3(x), w1(x), w2(x), c3, c2, c1</code><br>
                    <small style="color: #718096;">Tr√™s transa√ß√µes competindo pelo mesmo recurso.</small>
                </div>

                <div style="background: #f7fafc; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                    <strong>Exemplo 4: M√∫ltiplos Itens</strong><br>
                    <code>w1(x), w1(y), r2(x), r2(y), w2(x), w2(y), c1, c2</code><br>
                    <small style="color: #718096;">Opera√ß√µes em m√∫ltiplos itens de dados (X e Y).</small>
                </div>

                <h3>Dicas</h3>
                <ul style="margin-left: 20px; color: #4a5568;">
                    <li>Separe as opera√ß√µes por v√≠rgula ou espa√ßo</li>
                    <li>Use n√∫meros para identificar transa√ß√µes (1, 2, 3...)</li>
                    <li>Use letras para identificar itens de dados (x, y, z, a, b...)</li>
                    <li>Sempre finalize transa√ß√µes com commit (c1, c2, c3...)</li>
                    <li>O timestamp √© atribu√≠do automaticamente na primeira opera√ß√£o</li>
                </ul>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>